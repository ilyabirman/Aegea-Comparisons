$&&$(function(){var e,a,d=0,s=!1,t=!0;e2UpdateSubmittability=function(){shouldBeDisabled=!s||/^ *$/.test($("#password").val()),shouldBeDisabled?$("#submit-button").attr("disabled","disabled"):$("#submit-button").removeAttr("disabled")},e2AllCompleted=function(){e&&e.abort(),a&&a.abort(),Boolean(d)==("none"==$("#db-database-list").css("display"))&&$("#db-database-list").add("#db-database").toggle(),$(".e2-glass").fadeOut(333),t=!1},e2CheckDbConfig=function(i){d=0;var b,o;i&&$(".e2-ajax-loading").fadeIn(333),ajaxData={"db-server":$("#db-server").val(),"db-user":$("#db-user").val(),"db-password":$("#db-password").val(),"db-database":$("#db-database").val()},$.ajaxSetup({type:"post",timeout:1e4,data:ajaxData}),$("#db-server").get(0).e2OldValue=$("#db-server").val(),$("#db-user").get(0).e2OldValue=$("#db-user").val(),$("#db-password").get(0).e2OldValue=$("#db-password").val(),$("#db-database").get(0).e2OldValue=$("#db-database").val(),clearTimeout(document.e2TimeOut),document.e2TimeOut=setTimeout(function(){e&&e.abort(),a&&a.abort(),e=$.ajax({url:$("#e2-check-db-config-action").attr("href"),success:function(i){$(".db-everything-ok").removeClass("e2-verified").addClass("e2-wrong"),"no-connect"==i||("server-responding"==i?(t&&$("#db-user").focus(),$(".db-server-ok").removeClass("e2-wrong").addClass("e2-verified")):"server-lets-in"==i?($(".db-user-password-ok").removeClass("e2-wrong").addClass("e2-verified"),$(".db-server-ok, db-user-password-ok").removeClass("e2-wrong").addClass("e2-verified")):"data-incomplete"==i?($("#db-database-exists").slideUp(333),$("#db-database-incomplete").slideDown(333),$(".db-server-ok, db-user-password-ok").removeClass("e2-wrong").addClass("e2-verified")):"bingo-data-exists"==i?($("#db-database-incomplete").slideUp(333),$("#db-database-exists").slideDown(333),$(".db-everything-ok").removeClass("e2-wrong").addClass("e2-verified")):"bingo"==i&&($("#db-database-incomplete").slideUp(333),$("#db-database-exists").slideUp(333),t&&$("#password").focus(),$(".db-everything-ok").removeClass("e2-wrong").addClass("e2-verified"))),"no-connect"!=i?(e&&e.abort(),a&&a.abort(),a=$.ajax({url:$("#e2-list-databases-action").attr("href"),success:function(e){if(e){var a=e.split("|");if(valBefore=$("#db-database").val(),""==$("#db-database").val())$("#db-database").val(a[0]);else for(var s in a)if(a[s].match(RegExp("^"+$("#db-database").val()))){$("#db-database").val(a[s]);break}$("#db-database-list").empty();for(var s in a)++d,$("#db-database-list").append('<option id="db-database-option-'+a[s]+'">'+a[s]+"</option>");$("#db-database-list #db-database-option-"+$("#db-database").val()).attr("selected","selected"),$("#db-database").val($("#db-database-list option:selected").val()),$("#db-database-list").addClass("e2-verified"),valBefore!=$("#db-database").val()&&e2CheckDbConfig()}},error:function(){t&&$("#db-database").focus()},complete:function(e){o=!0,b&&o&&e2AllCompleted()}})):o=!0,s="bingo-data-exists"==i||"bingo"==i,e2UpdateSubmittability()},error:function(e){t&&($(".input-editable").removeAttr("disabled"),$("#db-server").add("#db-user").add("#db-password").add("#db-database").val(""),$("#db-server").focus(),setTimeout(function(){$(".e2-glass").fadeOut(333)},333),t=!1)},complete:function(e){$(".input-editable").removeAttr("disabled"),b=!0,b&&o&&e2AllCompleted(),$("#e2-console").html(e.responseText),$(".e2-ajax-loading").fadeOut(333)}})},333)},$(".input-editable").attr("disabled","disabled"),e2CheckDbConfig(),$(".input-editable").bind("input",function(){}),$(".e2-livecheckable").bind("input",function(){s=!1,$(".db-everything-ok").removeClass("e2-verified").removeClass("e2-wrong"),e2UpdateSubmittability()}),$(".e2-livecheckable").bind("blur",function(){"undefined"!=typeof this.e2OldValue&&$(this).val()==this.e2OldValue||($(this).removeClass("e2-verified").removeClass("e2-wrong"),e2CheckDbConfig(this))}),$("#db-database-list").bind("change",function(){$("#db-database").val($("#db-database-list").val()),e2CheckDbConfig(this)}),$("#password").bind("input",e2UpdateSubmittability)});