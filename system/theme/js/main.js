$&&$(function(){if(document.e2=document.e2||{},document.e2.mac=/Macintosh/.test(navigator.userAgent),document.e2.iosdevice=/(iPad)|(iPhone)/.test(navigator.userAgent),document.e2.opera=/Opera/.test(navigator.userAgent),$("a").each(function(){(redir=$(this).attr("linkredir"))&&($(this).attr("href",redir+$(this).attr("href")),$(this).attr("linkredir",""))}),document.e2.iosdevice&&$(".e2-comment-actions").removeClass("comment-secondary-controls"),document.getElementById("e2-login-sheet")){$("#e2-password").focus();var e,t=0,n=0,i=!1,s=function(){e&&clearTimeout(e),l=(1/(Math.pow(n,1.25)/20+.5)-.05)*Math.sin(n/2),document.getElementById("e2-login-window").style.transform="translateX("+(t+100*l)+"px)",n++,n<82?e=setTimeout(s,14):document.getElementById("e2-login-window").style.transform="translateX("+t+"px)"};$("#form-login").submit(function(){return!!i||($?($(".input-disableable").attr("disabled","disabled"),$("#e2-password").blur(),$("#password-checking").fadeIn(333),xhrCheckPassword=$.ajax({url:$("#e2-check-password-action").attr("href"),type:"post",timeout:1e4,data:{password:$("#e2-password").val()},success:function(e){$(".input-disableable").removeAttr("disabled"),"password-correct"==e?($("#password-checking").hide(),$("#password-correct").fadeIn(333),i=!0,setTimeout(function(){$("#form-login").submit()},333)):($("#password-checking").fadeOut(333),$("#e2-password").focus(),n=0,s())},error:function(){i=!0,$("#form-login").submit()}}),!1):""!=document.getElementById("e2-password").value&&void 0)})}$("#e2-visual-login").length&&($(document).mousemove(function(e){o=$("#e2-visual-login").offset(),x1=o.left,y1=o.top,x2=e.pageX,y2=e.pageY,l=Math.pow(Math.pow(x2-x1,2)+Math.pow(y2-y1,2),.5),l=Math.max(Math.min(l,600),100),l=(l-100)/500,$("#e2-visual-login").css("opacity",.25+.75*(1-l))}),$("#e2-visual-login").click(function(){return $("#e2-visual-login").css("visibility","hidden"),$("#e2-login-sheet").addClass("e2-show"),setTimeout(function(){$("#e2-password").focus()},100),!1})),$("#e2-subscribe-sheet").length&&$("#e2-note-subscribe-button").addClass("e2-note-subscribe-button-visible"),$("#e2-note-subscribe-button").length&&$("#e2-note-subscribe-button").click(function(){return $("#e2-subscribe-sheet").addClass("e2-show"),!1}),document.$e2HideLoginSheet=function(){$("#e2-password").blur(),$("#e2-login-sheet").removeClass("e2-show"),$("#e2-visual-login").css("visibility","visible")},document.$e2HideSubscribeSheet=function(){$("#e2-subscribe-sheet").removeClass("e2-show")},$("#e2-login-sheet").length&&$("#e2-login-sheet").click(function(e){$("#e2-login-sheet").hasClass("e2-hideable")&&e.target===this&&document.$e2HideLoginSheet()}),$("#e2-subscribe-sheet").length&&$("#e2-subscribe-sheet").click(function(e){e.target===this&&document.$e2HideSubscribeSheet()}),$(document).keyup(function(e){27==e.keyCode&&(document.$e2HideSubscribeSheet(),$("#e2-login-sheet").hasClass("e2-hideable")&&document.$e2HideLoginSheet())}),$("#e2-search").submit(function(){if(/^ *$/.test($("#query").val()))return!1}),$(".e2-search-input-input").focusin(function(){$(".e2-search-icon").addClass("e2-search-icon-focus")}),$(".e2-search-input-input").focusout(function(){$(".e2-search-icon").removeClass("e2-search-icon-focus")}),$(".e2-search-icon").click(function(){$(".e2-search-input-input").focus()}),$(document).bind("keydown keyup keypress",function(e){if(13==e.keyCode||13==e.which){var t=e.target||e.srcElement;if(t&&t.form){if($(t.form).hasClass("e2-enterable"))return;if(!e.ctrlKey&&$(t).is("textarea"))return;return e.preventDefault(),e.ctrlKey&&"keydown"==e.type&&($("#submit-button").attr("disabled")||$(t.form).submit()),!1}}}),$(document).bind("keyup",function(e){69!=e.keyCode&&69!=e.which||!e.altKey||$(".e2-edit-link").length>0&&(location.href=$(".e2-edit-link").eq(0).attr("href"))}),e2_ctrl_navi=function(e){window.event&&(e=window.event);var t=(e.srcElement||e.target).tagName;if(!/textarea|input/i.test(t)&&(document.e2.mac&&e.altKey&&!e.shiftKey||!document.e2.mac&&e.ctrlKey)){var n=null;37==e.keyCode&&(n=document.getElementById("link-prev")),39==e.keyCode&&(n=document.getElementById("link-next")),38==e.keyCode&&(n=document.getElementById("link-later")),40==e.keyCode&&(n=document.getElementById("link-earlier")),n&&n.href&&(location.href=n.href,window.event&&(window.event.returnValue=!1),e.preventDefault&&e.preventDefault())}},e2AutosizeTextFields=function(){var e=$(".e2-textarea-autosize")[0];if(e){var t=parseInt(e.style.height);if(e.scrollHeight>t)e.style.height=e.scrollHeight+"px";else for(;e.scrollHeight==t;)t-=50,e.style.height=t+"px",e.style.height=e.scrollHeight+"px";$(e).trigger("autosized")}},$(".e2-textarea-autosize").bind("input resize",e2AutosizeTextFields),e2AutosizeTextFields(),document.addEventListener?document.addEventListener("keyup",e2_ctrl_navi,!1):document.attachEvent&&document.attachEvent("onkeydown",e2_ctrl_navi)});